import{r as x,j as e,l as m,m as W,I as v,V as C,n as R,a as k,f as z,g as A,h as w,T as l,G as T,F as M,i as q,B as h,A as I,s as L,Z as N,k as o,q as d,a0 as E,a1 as V,a2 as U,p as F,e as Y,a3 as S}from"./index-MF_D1kqz.js";const $=({label:u="Password",placeholder:r,value:c,onChange:j,disabled:p=!1,fullWidth:b=!0,...f})=>{const[n,g]=x.useState(!1),y=()=>g(_=>!_);return e.jsx(m,{label:u,placeholder:r,type:n?"text":"password",value:c,onChange:j,disabled:p,fullWidth:b,variant:"outlined",InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(v,{onClick:y,edge:"end",children:n?e.jsx(C,{}):e.jsx(R,{})})})},...f})},G={first_name:"",last_name:"",profile_image:"",email:"",mobile_no:"",dob:null,role:"",password:""};function H(){const u=k(),{showToast:r}=z(),c=Y(),[j,p]=x.useState(!1),[b,f]=x.useState(G),[n,g]=x.useState(null),y=a=>{const i=a[0];i&&(i.preview=URL.createObjectURL(i),g(i))},_=async()=>{try{const{data:a,status:i,error:s}=await c("/api/profile","GET");if(i===200){const t=a.data;t.dob=t.dob?S(t.dob):null,t.user_type===1?t.role="Admin":t.user_type===2?t.role="Member":t.user_type===3?t.role="Participant":t.role="Unknown",f(t)}else f([])}catch{r("Failed to fetch profile.","error")}};x.useEffect(()=>{_()},[]);const P=A({first_name:w().required("First name is required"),last_name:w().required("Last name is required")}),D=async a=>{const i=new FormData;i.append("first_name",a.first_name),i.append("last_name",a.last_name),i.append("email",a.email),i.append("mobile_no",a.mobile_no),i.append("role",a.role),i.append("dob",a.dob?S(a.dob).format("YYYY-MM-DD"):""),n instanceof File&&i.append("profile_image",n),p(!0);try{const{status:s,error:t}=await c("/api/profile/update","PUT",i,!0);s===200?r("Profile updated successfully.","success"):r(t,"error")}catch{r("Failed to update profile.","error")}finally{p(!1)}};return e.jsxs("div",{style:{padding:"1.25rem",height:"100%",overflow:"auto"},children:[e.jsx(l,{variant:"subtitle1",fontSize:"1.5rem",fontWeight:500,children:"My Profile"}),e.jsx(T,{display:"flex",justifyContent:"center",alignItems:"center",sx:{my:"2rem"},children:e.jsx(M,{initialValues:b,enableReinitialize:!0,validationSchema:P,onSubmit:D,children:({values:a,errors:i,handleChange:s,setFieldValue:t})=>e.jsx(q,{style:{width:"100%",maxWidth:500,display:"flex",flexDirection:"column",gap:"16px"},children:e.jsxs(h,{component:"section",display:"flex",alignItems:"center",flexDirection:"column",gap:"1rem",sx:{height:"100%",padding:"1.5rem",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",width:"100%"},children:[e.jsx(I,{src:n?.preview||a.profile_image,...L(`${a.first_name} ${a.last_name}`),sx:{width:90,height:90,fontSize:"3rem",bgcolor:"rgb(229, 229, 229)",color:"black",fontWeight:"500",borderRadius:"10px"}}),e.jsxs("div",{children:[e.jsx(l,{variant:"h5",fontSize:"19px",children:"Profile picture"}),e.jsxs(l,{variant:"caption",fontSize:"0.75rem",children:["Accepting file type .png .jpg .jpeg ",e.jsx("br",{})," Max size 3MB"]})]}),e.jsx(N,{onDrop:y,name:"Change",selectedFile:n,multiple:!1,accept:{"image/*":[]}})]}),e.jsxs(h,{sx:{display:"flex",gap:"10px",width:"100%"},children:[e.jsxs(o,{fullWidth:!0,error:!!i.first_name,children:[e.jsx(l,{sx:{mx:.5,mb:.4},children:"First Name"}),e.jsx(m,{id:"first_name",type:"text",placeholder:"First Name",value:a.first_name,onChange:s,error:i.first_name}),i.first_name&&e.jsx(d,{sx:{mt:.5,mx:0},children:i.first_name})]}),e.jsxs(o,{fullWidth:!0,error:!!i.last_name,children:[e.jsx(l,{sx:{mx:.5,mb:.4},children:"Last Name"}),e.jsx(m,{id:"last_name",type:"text",placeholder:"Last Name",value:a.last_name,onChange:s,error:i.last_name}),i.last_name&&e.jsx(d,{sx:{mt:.5,mx:0},children:i.last_name})]})]}),e.jsxs(o,{fullWidth:!0,error:!!i.email,children:[e.jsx(l,{sx:{mx:.5,mb:.4},children:"Email"}),e.jsx(m,{id:"email",type:"email",disabled:!0,placeholder:"Email",value:a.email,onChange:s,error:i.email}),i.email&&e.jsx(d,{sx:{mt:.5,mx:0},children:i.email})]}),e.jsxs(o,{fullWidth:!0,error:!!i.mobile_no,children:[e.jsx(l,{sx:{mx:.5,mb:.4},children:"Mobile Number"}),e.jsx(m,{id:"mobile_no",type:"number",placeholder:"Mobile Number",value:a.mobile_no,onChange:s,error:i.mobile_no}),i.mobile_no&&e.jsx(d,{sx:{mt:.5,mx:0},children:i.mobile_no})]}),e.jsxs(h,{sx:{display:"flex",gap:"10px",width:"100%"},children:[e.jsxs(o,{fullWidth:!0,error:!!i.dob,children:[e.jsx(l,{sx:{mx:.5,mb:.4},children:"Date of Birth"}),e.jsx(E,{dateAdapter:V,children:e.jsx(U,{id:"dob",value:a.dob,onChange:B=>t("dob",B)})})]}),e.jsxs(o,{fullWidth:!0,error:!!i.role,children:[e.jsx(l,{sx:{mx:.5,mb:.4},children:"Role"}),e.jsx(m,{id:"role",disabled:!0,placeholder:"Role",value:a.role,onChange:s}),i.role&&e.jsx(d,{sx:{mt:.5,mx:0},children:i.role})]})]}),e.jsxs(o,{fullWidth:!0,error:!!i.password,children:[e.jsx(l,{sx:{mx:.5,mb:.4},children:"Password"}),e.jsx($,{value:a.password,onChange:s,disabled:!0,fullWidth:!0,label:""}),i.password&&e.jsx(d,{sx:{mt:.5,mx:0},children:i.password})]}),e.jsxs(h,{sx:{display:"flex",gap:"10px",justifyContent:"end",width:"100%"},children:[e.jsx(F,{variant:"contained",color:"",sx:{backgroundColor:"white",width:"100px",borderRadius:"10px",padding:"10px",fontWeight:"500",fontSize:"18px"},onClick:()=>u("/admin/dashboard"),children:"Cancel"}),e.jsx(F,{type:"submit",variant:"contained",color:"primary",loading:j,sx:{backgroundColor:"black",width:"100px",borderRadius:"10px",padding:"10px",fontWeight:"500",fontSize:"18px"},children:"Save"})]})]})})})})]})}export{H as default};
